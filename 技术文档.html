<!DOCTYPE html>
<!-- saved from url=(0084)file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>技术文档</title>
      
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="file:///C:/Users/Administrator/.vscode/extensions/shd101wyy.markdown-preview-enhanced-0.4.2/node_modules/@shd101wyy/mume/dependencies/katex/katex.min.css">
      
      

      
      <script type="text/javascript" src="file:///C:/Users/Administrator/.vscode/extensions/shd101wyy.markdown-preview-enhanced-0.4.2/node_modules/@shd101wyy/mume/dependencies/mermaid/mermaid.min.js" charset="UTF-8"></script>
      
      
      
      

      <style>
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}

/* highlight */
pre[data-line] {
  position: relative;
  padding: 1em 0 1em 3em;
}
pre[data-line] .line-highlight-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  background-color: transparent;
  display: block;
  width: 100%;
}

pre[data-line] .line-highlight {
  position: absolute;
  left: 0;
  right: 0;
  padding: inherit 0;
  margin-top: 1em;
  background: hsla(24, 20%, 50%,.08);
  background: linear-gradient(to right, hsla(24, 20%, 50%,.1) 70%, hsla(24, 20%, 50%,0));
  pointer-events: none;
  line-height: inherit;
  white-space: pre;
}

pre[data-line] .line-highlight:before, 
pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-start);
  position: absolute;
  top: .4em;
  left: .6em;
  min-width: 1em;
  padding: 0 .5em;
  background-color: hsla(24, 20%, 50%,.4);
  color: hsl(24, 20%, 95%);
  font: bold 65%/1.5 sans-serif;
  text-align: center;
  vertical-align: .3em;
  border-radius: 999px;
  text-shadow: none;
  box-shadow: 0 1px white;
}

pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-end);
  top: auto;
  bottom: .4em;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
.markdown-preview.markdown-preview {
  /*
  font-size: 16px;
  font-family: Segoe UI,幼圆;
  
  background-color: rgb(30, 30, 30); 
  color: rgb(249, 251, 255);
  strong {
    color: rgb(249, 251, 255);
  }
  h1 {
    font-size: 2.8em;
    color: rgb(72, 130, 255);
  }
  h2 {
    font-size: 2.4em;
    color: rgb(145, 202, 255);
  
  }
  h3 {
    font-size: 1.8em;
    color: #a1d181;
  }
  h4 {
    font-size: 1.4em;
    color: #cfe4c2;
  }
  h5, h6{
    font-size: 1.4em;
    color: #ffffff;
  }
  
  
  ul,
  ol {
    margin: 0 0 1.5em 1.5em;
  }
  ol li {
    list-style-type: decimal;
    list-style-position: outside;
  }
  ul li {
    list-style-type: disc;
    list-style-position: outside;
  }
  a {
    color: #d4dbf1;
    text-decoration: none;
  }
  a:focus {
      outline: thin dotted;
  }
  a:active,a:hover {
      outline: 0;
  }
  a:hover {
      color: #dadff7;
      text-decoration: underline;
  }
  a:visited {
      color: #f8faff;
  }
  
  
  table thead, table tr {
    border-top-width: 1px;
    border-top-style: solid;
    border-top-color: rgb(12, 12, 12);
  }
  table {
    border-bottom-width: 1px;
    border-bottom-style: solid;
    border-bottom-color: rgb(12, 12, 12);
  }
  thead,table td:nth-child(1){
    font-weight:bold;
    color: #6a92e9;
  }

  table td, table th {
    padding: 5px 10px;
    font-size: 12px;
    font-family: Verdana;
    color: rgb(149, 170, 109);
  }
  

  table tr:nth-child(even) {
    background: rgb(32, 32, 32)
  }
  table tr:nth-child(odd) {
    background: rgb(32, 32, 32)
  }
  
  pre{
    background: hsl(0, 0%, 88%);
  }*/
}
.markdown-preview.markdown-preview .margin-tb-zero,
.markdown-preview.markdown-preview .markdown-body ol ol,
.markdown-preview.markdown-preview .markdown-body ul ol,
.markdown-preview.markdown-preview .markdown-body ol ul,
.markdown-preview.markdown-preview .markdown-body ul ul,
.markdown-preview.markdown-preview .markdown-body ol ul ol,
.markdown-preview.markdown-preview .markdown-body ul ul ol,
.markdown-preview.markdown-preview .markdown-body ol ul ul,
.markdown-preview.markdown-preview .markdown-body ul ul ul {
  margin-top: 0;
  margin-bottom: 0;
}
.markdown-preview.markdown-preview .markdown-body {
  font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
  font-size: 16px;
  color: #333;
  line-height: 1.6;
  word-wrap: break-word;
  padding: 45px;
  background: #fff;
  border: 1px solid #ddd;
  -webkit-border-radius: 0 0 3px 3px;
  border-radius: 0 0 3px 3px;
}
.markdown-preview.markdown-preview .markdown-body > *:first-child {
  margin-top: 0 !important;
}
.markdown-preview.markdown-preview .markdown-body > *:last-child {
  margin-bottom: 0 !important;
}
.markdown-preview.markdown-preview .markdown-body * {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
.markdown-preview.markdown-preview .markdown-body h1,
.markdown-preview.markdown-preview .markdown-body h2,
.markdown-preview.markdown-preview .markdown-body h3,
.markdown-preview.markdown-preview .markdown-body h4,
.markdown-preview.markdown-preview .markdown-body h5,
.markdown-preview.markdown-preview .markdown-body h6 {
  margin-top: 1em;
  margin-bottom: 16px;
  font-weight: bold;
  line-height: 1.4;
}
.markdown-preview.markdown-preview .markdown-body p,
.markdown-preview.markdown-preview .markdown-body blockquote,
.markdown-preview.markdown-preview .markdown-body ul,
.markdown-preview.markdown-preview .markdown-body ol,
.markdown-preview.markdown-preview .markdown-body dl,
.markdown-preview.markdown-preview .markdown-body table,
.markdown-preview.markdown-preview .markdown-body pre {
  margin-top: 0;
  margin-bottom: 16px;
}
.markdown-preview.markdown-preview .markdown-body h1 {
  margin: 0.67em 0;
  padding-bottom: 0.3em;
  font-size: 2.25em;
  line-height: 1.2;
  border-bottom: 1px solid #eee;
}
.markdown-preview.markdown-preview .markdown-body h2 {
  padding-bottom: 0.3em;
  font-size: 1.75em;
  line-height: 1.225;
  border-bottom: 1px solid #eee;
}
.markdown-preview.markdown-preview .markdown-body h3 {
  font-size: 1.5em;
  line-height: 1.43;
}
.markdown-preview.markdown-preview .markdown-body h4 {
  font-size: 1.25em;
}
.markdown-preview.markdown-preview .markdown-body h5 {
  font-size: 1em;
}
.markdown-preview.markdown-preview .markdown-body h6 {
  font-size: 1em;
  color: #777;
}
.markdown-preview.markdown-preview .markdown-body ol,
.markdown-preview.markdown-preview .markdown-body ul {
  padding-left: 2em;
}
.markdown-preview.markdown-preview .markdown-body ol ol,
.markdown-preview.markdown-preview .markdown-body ul ol {
  list-style-type: lower-roman;
}
.markdown-preview.markdown-preview .markdown-body ol ul,
.markdown-preview.markdown-preview .markdown-body ul ul {
  list-style-type: circle;
}
.markdown-preview.markdown-preview .markdown-body ol ul ul,
.markdown-preview.markdown-preview .markdown-body ul ul ul {
  list-style-type: square;
}
.markdown-preview.markdown-preview .markdown-body ol {
  list-style-type: decimal;
}
.markdown-preview.markdown-preview .markdown-body ul {
  list-style-type: disc;
}
.markdown-preview.markdown-preview .markdown-body blockquote {
  margin-left: 0;
  margin-right: 0;
  padding: 0 15px;
  color: #777;
  border-left: 4px solid #ddd;
}
.markdown-preview.markdown-preview .markdown-body table {
  display: block;
  width: 100%;
  overflow: auto;
  word-break: normal;
  word-break: keep-all;
  border-collapse: collapse;
  border-spacing: 0;
}
.markdown-preview.markdown-preview .markdown-body table tr {
  background-color: #fff;
  border-top: 1px solid #ccc;
}
.markdown-preview.markdown-preview .markdown-body table tr:nth-child(2n) {
  background-color: #f8f8f8;
}
.markdown-preview.markdown-preview .markdown-body table th,
.markdown-preview.markdown-preview .markdown-body table td {
  padding: 6px 13px;
  border: 1px solid #ddd;
}
.markdown-preview.markdown-preview .markdown-body pre {
  word-wrap: normal;
  padding: 16px;
  overflow: auto;
  font-size: 85%;
  line-height: 1.45;
  background-color: #f7f7f7;
  -webkit-border-radius: 3px;
  border-radius: 3px;
}
.markdown-preview.markdown-preview .markdown-body pre code {
  display: inline;
  max-width: initial;
  padding: 0;
  margin: 0;
  overflow: initial;
  font-size: 100%;
  line-height: inherit;
  word-wrap: normal;
  white-space: pre;
  border: 0;
  -webkit-border-radius: 3px;
  border-radius: 3px;
  background-color: transparent;
}
.markdown-preview.markdown-preview .markdown-body pre code:before,
.markdown-preview.markdown-preview .markdown-body pre code:after {
  content: normal;
}
.markdown-preview.markdown-preview .markdown-body code {
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  padding: 0;
  padding-top: 0.2em;
  padding-bottom: 0.2em;
  margin: 0;
  font-size: 85%;
  background-color: rgba(0, 0, 0, 0.04);
  -webkit-border-radius: 3px;
  border-radius: 3px;
}
.markdown-preview.markdown-preview .markdown-body code:before,
.markdown-preview.markdown-preview .markdown-body code:after {
  letter-spacing: -0.2em;
  content: "\00a0";
}
.markdown-preview.markdown-preview .markdown-body a {
  color: #4078c0;
  text-decoration: none;
  background: transparent;
}
.markdown-preview.markdown-preview .markdown-body img {
  max-width: 100%;
  max-height: 100%;
  -webkit-border-radius: 4px;
  border-radius: 4px;
  -webkit-box-shadow: 0 0 10px #555;
  box-shadow: 0 0 10px #555;
}
.markdown-preview.markdown-preview .markdown-body strong {
  font-weight: bold;
}
.markdown-preview.markdown-preview .markdown-body em {
  font-style: italic;
}
.markdown-preview.markdown-preview .markdown-body del {
  text-decoration: line-through;
}
.markdown-preview.markdown-preview .task-list-item {
  list-style-type: none;
}
.markdown-preview.markdown-preview .task-list-item input {
  font: 13px/1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
  margin: 0 0.35em 0.25em -1.6em;
  vertical-align: middle;
}
.markdown-preview.markdown-preview .task-list-item input[disabled] {
  cursor: default;
}
.markdown-preview.markdown-preview .task-list-item input[type="checkbox"] {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  padding: 0;
}
.markdown-preview.markdown-preview .task-list-item input[type="radio"] {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  padding: 0;
}

      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview  ">
      <ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#1-%E5%91%BD%E5%90%8D%E8%A7%84%E8%8C%83%E5%92%8C%E5%85%B6%E4%BB%96%E4%B8%80%E4%BA%9B%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB%E7%9A%84%E6%80%BB%E5%88%99">1. 命名规范和其他一些杂七杂八的总则</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#11-%E5%90%8D%E8%AF%8D">1.1. 名词</a></li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#12-%E5%85%B3%E4%BA%8E%E8%A7%A6%E5%8F%91%E5%99%A8">1.2. 关于触发器</a></li>
</ul>
</li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#%E5%A4%96%E9%83%A8%E6%95%B0%E6%8D%AE%E5%BA%93">外部数据库</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#%E5%8D%95%E4%BD%8D%E6%95%B0%E6%8D%AE%E5%BA%93">单位数据库</a></li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#%E5%8D%A1%E7%89%8C%E6%95%B0%E6%8D%AE%E5%BA%93">卡牌数据库</a></li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#%E4%BA%8B%E4%BB%B6%E6%95%B0%E6%8D%AE%E5%BA%93">事件数据库</a></li>
</ul>
</li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#2-%E7%B1%BB%E8%AF%B4%E6%98%8E">2. 类说明</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#21-%E6%B8%B8%E6%88%8F%E8%BF%90%E8%A1%8C">2.1. 游戏运行</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#211-GamePlay">2.1.1. GamePlay</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#2111-%E9%87%8D%E6%9E%84%E9%83%A8%E5%88%86">2.1.1.1. 重构部分</a></li>
</ul>
</li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#212-Encounter">2.1.2. Encounter</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#2121-%E9%87%8D%E6%9E%84%E9%83%A8%E5%88%86">2.1.2.1. 重构部分</a></li>
</ul>
</li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#213-EncounterData">2.1.3. EncounterData</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#2131-%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98">2.1.3.1. 重要成员</a></li>
</ul>
</li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#214-Damage">2.1.4. Damage</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#2141-%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98">2.1.4.1. 重要成员</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#22-%E9%81%AD%E9%81%87%E5%8F%8A%E5%9C%B0%E5%9B%BE">2.2. 遭遇及地图</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#221-BMBCollider">2.2.1. BMBCollider</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#2211-%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98">2.2.1.1. 重要成员</a></li>
</ul>
</li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#222-BattaleMap">2.2.2. BattaleMap</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#2221-%E9%87%8D%E6%9E%84%E9%83%A8%E5%88%86">2.2.2.1. 重构部分：</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#23-%E7%8E%A9%E5%AE%B6%E8%BE%93%E5%85%A5%E6%8E%A7%E5%88%B6">2.3. 玩家输入控制</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#231-GameplayInput">2.3.1. GameplayInput</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#2311-%E9%87%8D%E6%9E%84%E9%83%A8%E5%88%86">2.3.1.1. 重构部分</a></li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#2312-%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98">2.3.1.2. 重要成员</a></li>
</ul>
</li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#232-InputFSM">2.3.2. InputFSM</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#2321-%E9%87%8D%E6%9E%84%E9%83%A8%E5%88%86">2.3.2.1. 重构部分</a></li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#2322-%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98">2.3.2.2. 重要成员</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#24-%E5%8D%A1%E7%89%8C">2.4. 卡牌</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#241-BaseCard">2.4.1. BaseCard</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#2411-%E9%87%8D%E6%9E%84%E9%83%A8%E5%88%86">2.4.1.1. 重构部分</a></li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#2412-%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98">2.4.1.2. 重要成员</a></li>
</ul>
</li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#242-UnitCard">2.4.2. UnitCard</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#2421-%E9%87%8D%E6%9E%84%E9%83%A8%E5%88%86">2.4.2.1. 重构部分</a></li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#2422-%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98">2.4.2.2. 重要成员</a></li>
</ul>
</li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#243-OrderCard">2.4.3. OrderCard</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#2431-%E9%87%8D%E6%9E%84%E9%83%A8%E5%88%86">2.4.3.1. 重构部分</a></li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#2432-%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98">2.4.3.2. 重要成员</a></li>
</ul>
</li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#244-CardManager">2.4.4. CardManager</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#2441-%E9%87%8D%E6%9E%84%E9%83%A8%E5%88%86">2.4.4.1. 重构部分</a></li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#2442-%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98">2.4.4.2. 重要成员</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#25-%E5%8D%95%E4%BD%8D">2.5. 单位</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#251-GameUnit">2.5.1. GameUnit</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#2511-%E9%87%8D%E6%9E%84%E9%83%A8%E5%88%86">2.5.1.1. 重构部分</a></li>
</ul>
</li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#252-Hero---New">2.5.2. Hero - New!</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#2521-%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98">2.5.2.1. 重要成员</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#26-%E5%BC%82%E8%83%BD%E4%B8%8E%E6%95%88%E6%9E%9C">2.6. 异能与效果</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#261-EffectStack---New">2.6.1. EffectStack - New！</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#2611-%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98">2.6.1.1. 重要成员</a></li>
</ul>
</li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#262-Effect---New">2.6.2. Effect - New！</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#2621-%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98">2.6.2.1. 重要成员</a></li>
</ul>
</li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#263-Ability">2.6.3. Ability</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#2631-%E9%87%8D%E6%9E%84%E5%86%85%E5%AE%B9">2.6.3.1. 重构内容</a></li>
</ul>
</li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#264-Buff">2.6.4. Buff</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#2641-%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98">2.6.4.1. 重要成员</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#27-%E4%BA%8B%E4%BB%B6">2.7. 事件</a></li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#28-%E4%BF%A1%E6%81%AF%E6%94%B6%E5%8F%91">2.8. 信息收发</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#281-MsgDispatcher">2.8.1. MsgDispatcher</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#2811-%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98">2.8.1.1. 重要成员</a></li>
</ul>
</li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#282-Trigger">2.8.2. Trigger</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#2821-%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98">2.8.2.1. 重要成员</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#3-%E9%81%AD%E9%81%87%E8%BF%90%E8%A1%8C%E9%80%BB%E8%BE%91%E6%8E%A7%E5%88%B6%E5%92%8C%E6%B5%81%E7%A8%8B">3. 遭遇运行逻辑控制和流程</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#31-%E9%81%AD%E9%81%87%E5%88%9D%E5%A7%8B%E5%8C%96">3.1. 遭遇初始化</a></li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#32-%E5%9B%9E%E5%90%88%E5%BC%80%E5%A7%8B---%E4%BB%8EAIEnd%E5%88%B0MPBegin">3.2. 回合开始 - 从AIEnd到MPBegin</a></li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#33-%E5%9B%9E%E5%90%88%E7%BB%93%E6%9D%9F---%E4%BB%8EMPEnd%E5%88%B0AIBegin">3.3. 回合结束 - 从MPEnd到AIBegin</a></li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#34-%E5%8D%95%E4%BD%8D%E9%83%A8%E7%BD%B2">3.4. 单位部署</a></li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#35-%E6%88%98%E6%96%97%E7%BB%93%E7%AE%97">3.5. 战斗结算</a></li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#36-%E6%95%88%E6%9E%9C%E9%93%BE%E6%89%A7%E8%A1%8C">3.6. 效果链执行</a></li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#37-%E5%A0%86%E5%8F%A0%E7%9A%84%E8%BF%90%E4%BD%9C%E6%9C%BA%E5%88%B6">3.7. 堆叠的运作机制</a></li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#38-%E5%8D%A1%E7%89%8C%E6%96%BD%E6%94%BE">3.8. 卡牌施放</a></li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#39-%E5%BC%82%E8%83%BD%E8%A7%A6%E5%8F%91">3.9. 异能触发</a></li>
</ul>
</li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#4-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9%E5%92%8C%E9%80%9A%E7%94%A8%E7%B1%BB%E7%9A%84%E4%BD%BF%E7%94%A8">4. 注意事项和通用类的使用</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#41-FSMachineT%E5%92%8CFSMState">4.1. FSMachine<t>和FSMState</t></a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#411-%E4%BE%8B%E5%AD%90">4.1.1. 例子：</a></li>
</ul>
</li>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#42-UnitySingleton">4.2. UnitySingleton</a>
<ul>
<li><a href="file:///C:/Users/Administrator/AppData/Local/Temp/mume201962-21716-3tw7ac.ti3pb.html#421-%E4%BE%8B%E5%AD%90">4.2.1. 例子：</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 class="mume-header" id="1-%E5%91%BD%E5%90%8D%E8%A7%84%E8%8C%83%E5%92%8C%E5%85%B6%E4%BB%96%E4%B8%80%E4%BA%9B%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB%E7%9A%84%E6%80%BB%E5%88%99">1. 命名规范和其他一些杂七杂八的总则</h1>

<p>尽量遵守吧</p>
<h2 class="mume-header" id="11-%E5%90%8D%E8%AF%8D">1.1. 名词</h2>

<ul>
<li>法咒（Ark）
<ul>
<li>原先的战技</li>
</ul>
</li>
<li>战区（Region）</li>
<li>范围（Area）
<ul>
<li>主要指的是施法的影响范围，分为爆发范围（BurstArea）和射线范围（LaserArea）两种。</li>
</ul>
</li>
<li>单位（Unit）</li>
<li>回合（Turn）</li>
<li>光环（Halo）</li>
<li>手牌（Hand）</li>
<li>牌库（Deck）
<ul>
<li>指的是被抽的那个牌库</li>
</ul>
</li>
<li>阶段（Phase）</li>
<li>触发器（Trigger）</li>
<li>异能（Ability）</li>
<li>咒语（Spell）</li>
<li>召唤（Summon）</li>
</ul>
<h2 class="mume-header" id="12-%E5%85%B3%E4%BA%8E%E8%A7%A6%E5%8F%91%E5%99%A8">1.2. 关于触发器</h2>

<p>触发器（Trigger）中的信息类型不是用来触发去做某件事的。</p>
<p>比如MessageType中的DrawCard，我发送DrawCard信息不是为了去抽一张牌，而是为了告知其他Reciver我抽了一张牌。要抽牌的时候请调用抽牌的方法。</p>
<p>也就是说，我不是发送抽牌信号来抽牌，而是因为我抽了牌所以发送抽牌信号；我不是发送施放咒语信号来施放咒语，而是因为我施放了咒语所以发送施放咒语信号。能够在Gameplay里明确定向到具体固定方法的时候不要依赖Trigger来实现。</p>
<h1 class="mume-header" id="%E5%A4%96%E9%83%A8%E6%95%B0%E6%8D%AE%E5%BA%93">外部数据库</h1>

<h2 class="mume-header" id="%E5%8D%95%E4%BD%8D%E6%95%B0%E6%8D%AE%E5%BA%93">单位数据库</h2>

<pre data-role="codeBlock" data-info="json" class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"Ability"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"单位所具有的异能列表"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"Atk"</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
  <span class="token property">"Color"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">"U"</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"Text"</span><span class="token operator">:</span> <span class="token string">"单位所记录的文本"</span><span class="token punctuation">,</span>
  <span class="token property">"Event"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">"这里是"</span><span class="token operator">:</span><span class="token string">"事件模块"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"HasCD"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">"Hp"</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  <span class="token property">"ID"</span><span class="token operator">:</span> <span class="token string">"单位ID"</span><span class="token punctuation">,</span>
  <span class="token property">"Mov"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">"Name"</span><span class="token operator">:</span> <span class="token string">"单位名字"</span><span class="token punctuation">,</span>
  <span class="token property">"Spd"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">"Rng"</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token property">"Tag"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">"传奇"</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"Ct"</span><span class="token operator">:</span><span class="token number">0</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</pre><h2 class="mume-header" id="%E5%8D%A1%E7%89%8C%E6%95%B0%E6%8D%AE%E5%BA%93">卡牌数据库</h2>

<pre data-role="codeBlock" data-info="json" class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"ID"</span><span class="token operator">:</span> <span class="token string">"这里是卡牌id"</span><span class="token punctuation">,</span>
    <span class="token property">"Spell"</span><span class="token operator">:</span><span class="token string">"这里是卡牌携带的Spell"</span><span class="token punctuation">,</span>
    <span class="token property">"Unit"</span><span class="token operator">:</span><span class="token string">"这里是卡牌对应的单位id"</span><span class="token punctuation">,</span>
    <span class="token property">"Color"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">"G"</span><span class="token punctuation">,</span>
        <span class="token string">"R"</span><span class="token punctuation">,</span>
        <span class="token string">"U"</span><span class="token punctuation">,</span>
        <span class="token string">"P"</span><span class="token punctuation">,</span>
        <span class="token string">"W"</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"Cost"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">"Text"</span><span class="token operator">:</span> <span class="token string">"这里是卡牌具有的文本"</span><span class="token punctuation">,</span>
    <span class="token property">"Flavor"</span><span class="token operator">:</span> <span class="token string">"这里是卡牌的风味文字"</span><span class="token punctuation">,</span>
    <span class="token property">"Name"</span><span class="token operator">:</span> <span class="token string">"卡牌名称"</span><span class="token punctuation">,</span>
    <span class="token property">"Tag"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">"这里是标签"</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"AbilityAttach"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">"附加给携带者的异能列表"</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"Type"</span><span class="token operator">:</span> <span class="token string">"Order / Unit"</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</pre><h2 class="mume-header" id="%E4%BA%8B%E4%BB%B6%E6%95%B0%E6%8D%AE%E5%BA%93">事件数据库</h2>

<h1 class="mume-header" id="2-%E7%B1%BB%E8%AF%B4%E6%98%8E">2. 类说明</h1>

<h2 class="mume-header" id="21-%E6%B8%B8%E6%88%8F%E8%BF%90%E8%A1%8C">2.1. 游戏运行</h2>

<ul>
<li>如果确认GameJudge没有用，记得把他删了。</li>
<li>Mediator的内容也想办法删了。AbilityMediator里面的内容陆陆续续移动到其他地方，Deck类换一个地方摆着。</li>
</ul>
<h3 class="mume-header" id="211-gameplay">2.1.1. GamePlay</h3>

<p>命名空间：GamePlay</p>
<p>说明：游戏逻辑的单例管理类，原则上，除UI和数据库外的大类都应被GamePlay持有以方便全局调用并管理，用这种方式避免使用额外的单例造成负担。<br>
实现细节：类的创建均放在了Awake()中，避免有脚本图方便在Start中调用大类造成错误。在战斗地图中所有类一律不准使用Awake()做初始化和逻辑的处理，请在Start里做</p>
<h4 class="mume-header" id="2111-%E9%87%8D%E6%9E%84%E9%83%A8%E5%88%86">2.1.1.1. 重构部分</h4>

<ul>
<li>把BattleMap的start内容移到Gameplay的start下面来。</li>
<li>把回合自流动的部分转移到RoundProcessController下面去。</li>
<li>取消移动范围显示的代码去该去的地方……我也不知道该去哪里但应该不是gameplay。</li>
<li>初始化过程中在这里注册全局Trigger。</li>
</ul>
<h3 class="mume-header" id="212-encounter">2.1.2. Encounter</h3>

<p>命名空间：GamePlay</p>
<p>说明：全局信息。</p>
<h4 class="mume-header" id="2121-%E9%87%8D%E6%9E%84%E9%83%A8%E5%88%86">2.1.2.1. 重构部分</h4>

<ul>
<li>加入成员，以后统一从此处查询：
<ul>
<li>玩家死页数</li>
<li>最大可持有死页数</li>
<li>玩家最大手牌数</li>
<li>玩家初始手牌数</li>
<li>玩家每回合抽牌数</li>
<li>玩家当前专注</li>
<li>玩家默认专注</li>
<li>isLeader的单位实例</li>
</ul>
</li>
</ul>
<h3 class="mume-header" id="213-encounterdata">2.1.3. EncounterData</h3>

<p>命名空间：GamePlay.Encounter</p>
<p>说明：遭遇数据的单例管理类。汇总和管理所有与遭遇相关的成员和方法。大部分情况被BattaleMap或BattleArea调用</p>
<h4 class="mume-header" id="2131-%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98">2.1.3.1. 重要成员</h4>

<ul>
<li>public void InitEncounter(string encounterID)
<ul>
<li>根据遭遇ID从json文件读取对应的遭遇数据，并将其保存在私有成员_encounterData中</li>
</ul>
</li>
<li>public void InitBattleFieldEvent(string encounterID)
<ul>
<li>根据遭遇ID从encounterData中读取战区事件，并保存在私有成员battleAreaEventsDic中</li>
</ul>
</li>
<li>public List<eventmodel> GetBattleFieldEvent(int regionID)
<ul>
<li>根据战区ID从battleAreaEventsDic中读取战区事件列表</li>
</ul>
</eventmodel></li>
<li>public BattlefieldMessage GetBattlefieldMessagebyID(int regionID,string encounterID)
<ul>
<li>根据战区ID和遭遇ID从encounterData中读取战区列表battleFieldMessageList，并从battleFieldMessageList中读取对应战区ID的战区</li>
</ul>
</li>
</ul>
<h3 class="mume-header" id="214-damage">2.1.4. Damage</h3>

<p>命名空间：GamePlay</p>
<p>说明：伤害类，存储伤害的信息和伤害公式。</p>
<h4 class="mume-header" id="2141-%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98">2.1.4.1. 重要成员</h4>

<ul>
<li>public Damage(int damageValue)
<ul>
<li>伤害的构造方法。</li>
</ul>
</li>
<li>public static void DealDamage(GameUnit.GameUnit source, GameUnit.GameUnit taker, Damage damage, bool post = true)
<ul>
<li>对一个单位造成伤害。source为伤害来源，taker为受伤者，damage为伤害实例。post默认为true，为是否发送伤害发生的信息，如无特别需要不需更改。</li>
</ul>
</li>
<li>public static void DealDamages(List&lt;GameUnit.GameUnit&gt; sources, List&lt;GameUnit.GameUnit&gt; takers, List<damage> damages)
<ul>
<li>想同时造成多个伤害时使用的方法。造成这些伤害的间隙因为不发送伤害信息不会插入其他代码的执行。</li>
</ul>
</damage></li>
</ul>
<h2 class="mume-header" id="22-%E9%81%AD%E9%81%87%E5%8F%8A%E5%9C%B0%E5%9B%BE">2.2. 遭遇及地图</h2>

<h3 class="mume-header" id="221-bmbcollider">2.2.1. BMBCollider</h3>

<p>说明：碰撞器，主要进行碰撞检测，指定范围之后每次当碰撞器可能发生变化的时候进行刷新。</p>
<h4 class="mume-header" id="2211-%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98">2.2.1.1. 重要成员</h4>

<ul>
<li>public BMBCollider(GameUnit.GameUnit unit, List<vector2> bound)</vector2></li>
<li>public BMBCollider(BattleMapBlock mapBlock, List<vector2> bound)
<ul>
<li>第一类构造方法，参数是中心和对于中心相对位置。当中心移动的时候碰撞器检测的地格会跟随改变，依靠相对位置刷新。</li>
</ul>
</vector2></li>
<li>public BMBCollider(GameUnit.GameUnit unit, bool isBMA)
<ul>
<li>第二类构造方法，参数是检测单位和是否战区碰撞器。当其为真时碰撞器将会把与参数单位同属于一个战区的地格纳入检测之中。当单位移动进入另一个战区时，碰撞器检查的地格会随之更新。</li>
</ul>
</li>
<li>public BMBCollider(List<vector2> battleArea)
<ul>
<li>第四类构造方法，恒定碰撞器，固定检测几个地格的变化。参数是指定的检测范围。</li>
</ul>
</vector2></li>
<li>public List<unit> enterUnits = new List<unit>();
<ul>
<li>进入此碰撞监测区域的单位。</li>
</ul>
</unit></unit></li>
<li>public List<unit> exitUnits = new List<unit>();
<ul>
<li>离开此碰撞检测区域的单位。</li>
</ul>
</unit></unit></li>
<li>public List<unit> disposeUnits = new List<unit>();
<ul>
<li>在这个碰撞检测区域内的单位。</li>
</ul>
</unit></unit></li>
</ul>
<h3 class="mume-header" id="222-battalemap">2.2.2. BattaleMap</h3>

<p>命名空间：BattleMap</p>
<p>说明：战斗地图的单例管理类。汇总和管理所有与战斗地图相关的成员和方法</p>
<h4 class="mume-header" id="2221-%E9%87%8D%E6%9E%84%E9%83%A8%E5%88%86">2.2.2.1. 重构部分：</h4>

<ul>
<li>InitMap的工作移交Gameplay，改为主力负责InitAndInstantiateMapBlocks。</li>
</ul>
<h2 class="mume-header" id="23-%E7%8E%A9%E5%AE%B6%E8%BE%93%E5%85%A5%E6%8E%A7%E5%88%B6">2.3. 玩家输入控制</h2>

<h3 class="mume-header" id="231-gameplayinput">2.3.1. GameplayInput</h3>

<p>命名空间：Gameplay.Input</p>
<p>说明：玩家输入的控制类，被GamePlay持有引用，游戏操作逻辑的真正执行实际由成员InputFSM处理。GameplayInput只是将接口暴露在全局，并与InputFSM进行对接</p>
<h4 class="mume-header" id="2311-%E9%87%8D%E6%9E%84%E9%83%A8%E5%88%86">2.3.1.1. 重构部分</h4>

<ul>
<li>添加左键点击和右键点击的接口。
<ul>
<li>完成对应的暴露出来的方法。</li>
<li>执行对应方法的时候对EventData里面的Button进行检测，检查是Left还是Right。</li>
</ul>
</li>
<li>添加点击待命区（CD池）和事件区的接口。</li>
</ul>
<h4 class="mume-header" id="2312-%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98">2.3.1.2. 重要成员</h4>

<ul>
<li>public InputFSM InputFSM
<ul>
<li>玩家输入的执行器，真正根据情况选择不同游戏逻辑的执行者</li>
</ul>
</li>
<li>public void OnPointerDownBlock(BattleMapBlock mapBlock, PointerEventData eventData)
<ul>
<li>暴露给棋子和地图方块的操作接口，调用时机和函数名一致。例如这个就是左键点击地图块的接口。</li>
</ul>
</li>
<li>public void OnPointerDownFriendlyLeft(GameUnit.GameUnit unit, PointerEventData eventData)
<ul>
<li>左键点击友方单位。</li>
</ul>
</li>
<li>public void OnPointerDownEnemyLeft(GameUnit.GameUnit unit, PointerEventData eventData)
<ul>
<li>左键点击敌方单位。</li>
</ul>
</li>
<li>internal void OnPointerDownUnitCardLeft(GameObject currentItemInstance)
<ul>
<li>点击手牌中的单位牌。</li>
</ul>
</li>
<li>public void OnUseOrderCard(Ability.Spell spell)
<ul>
<li>点击手中的指令牌并使用之。</li>
</ul>
</li>
<li>public void OnPointerDownCdHeroLeft(GameObject currentItemInstance)
<ul>
<li>点击恢复区正在恢复的英雄。</li>
</ul>
</li>
<li>public void OnPointerDownChoisenCard(GameObject currentItemInstance)
<ul>
<li>点击弹框中备选的卡牌选项。</li>
</ul>
</li>
</ul>
<h3 class="mume-header" id="232-inputfsm">2.3.2. InputFSM</h3>

<p>命名空间：Gameplay.FSM</p>
<p>说明：执行玩家输入的有限状态机，通过变更成员StateStack的栈顶来调节对玩家操作的响应。StateStack是为了可以实现操作回撤，即下推状态机（然而现在看起来完全没有打算做这个回撤的打算）。为了方便状态的切换，InputFSM会寄存部分玩家的输入信息。</p>
<h4 class="mume-header" id="2321-%E9%87%8D%E6%9E%84%E9%83%A8%E5%88%86">2.3.2.1. 重构部分</h4>

<ul>
<li>TargetList改为存储点击的对象。这一项处理起来可能会相对比较困难，要重写很多东西。</li>
<li>SelectState和CastState要能够正确处理各项右键点击进行撤回和取消。</li>
</ul>
<h4 class="mume-header" id="2322-%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98">2.3.2.2. 重要成员</h4>

<ul>
<li>public List<object> TargetList;
<ul>
<li>存储点击的对象</li>
</ul>

<li>public Ability.Ability ability;
<ul>
<li>存储当前正要处理的异能，用来处理和异能相关的内容</li>
</ul>
</li>

<h2 class="mume-header" id="24-%E5%8D%A1%E7%89%8C">2.4. 卡牌</h2>

<h3 class="mume-header" id="241-basecard">2.4.1. BaseCard</h3>

<p>命名空间：GameCard</p>
<p>说明：卡牌的基类。</p>
<h4 class="mume-header" id="2411-%E9%87%8D%E6%9E%84%E9%83%A8%E5%88%86">2.4.1.1. 重构部分</h4>

<ul>
<li>依照新的成员结构进行更新。</li>
</ul>
<h4 class="mume-header" id="2412-%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98">2.4.1.2. 重要成员</h4>

<ul>
<li>string id
<ul>
<li>卡牌的id，作为从数据库索取相关卡片信息的唯一标识。</li>
</ul>
</li>
<li>string name
<ul>
<li>卡牌的名称</li>
</ul>
</li>
<li>int cost
<ul>
<li>卡牌需要消耗的专注值</li>
</ul>
</li>
<li>List<color> color
<ul>
<li>卡牌所具有的颜色。</li>
</ul>
</color></li>
<li>Type type
<ul>
<li>卡牌是咒语型（指令牌）还是召唤型（单位牌）。</li>
</ul>
</li>
<li>List<string> tags
<ul>
<li>卡牌所具有的标签。</li>
</ul>
</string></li>
<li>string text
<ul>
<li>卡牌所记述的规则文字。</li>
</ul>
</li>
<li>string flavorText
<ul>
<li>卡牌所记述的风味文字。</li>
</ul>
</li>
<li>bool willDestroy
<ul>
<li>关于卡牌是否在生效后被销毁。</li>
</ul>
</li>
<li>Hero carrier
<ul>
<li>这张牌的携带者。</li>
</ul>
</li>
</ul>
<h3 class="mume-header" id="242-unitcard">2.4.2. UnitCard</h3>

<p>命名空间：GameCard</p>
<p>说明：召唤牌，也就是过去的单位牌，BaseCard的子类。</p>
<h4 class="mume-header" id="2421-%E9%87%8D%E6%9E%84%E9%83%A8%E5%88%86">2.4.2.1. 重构部分</h4>

<ul>
<li>将部分成员移交到GameCard所独有。</li>
</ul>
<h4 class="mume-header" id="2422-%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98">2.4.2.2. 重要成员</h4>

<ul>
<li>string unitid
<ul>
<li>所召唤的单位的id。</li>
</ul>
</li>
<li>List<string> abilitiesOnUnit
<ul>
<li>所召唤的单位除了数据库所记述的异能以外额外获得的异能的id。</li>
</ul>
</string></li>
</ul>
<h3 class="mume-header" id="243-ordercard">2.4.3. OrderCard</h3>

<p>命名空间：GameCard</p>
<p>说明：咒语牌，也就是过去的指令牌，BaseCard的子类。</p>
<h4 class="mume-header" id="2431-%E9%87%8D%E6%9E%84%E9%83%A8%E5%88%86">2.4.3.1. 重构部分</h4>

<ul>
<li>修改咒语牌的发动方式，去Trigger化。详情见</li>
</ul>
<h4 class="mume-header" id="2432-%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98">2.4.3.2. 重要成员</h4>

<ul>
<li>string spell
<ul>
<li>携带的咒语id。</li>
</ul>
</li>
</ul>
<h3 class="mume-header" id="244-cardmanager">2.4.4. CardManager</h3>

<p>命名空间：GameCard</p>
<p>说明：卡牌管理器。</p>
<h4 class="mume-header" id="2441-%E9%87%8D%E6%9E%84%E9%83%A8%E5%88%86">2.4.4.1. 重构部分</h4>

<ul>
<li>把一些变量转移到Encounter类去。详情见</li>
<li>把一些用于测试的方法处理一下。</li>
<li>手牌、牌库和待命区直接储存实例。</li>
</ul>
<h4 class="mume-header" id="2442-%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98">2.4.4.2. 重要成员</h4>

<p>待补充</p>
<h2 class="mume-header" id="25-%E5%8D%95%E4%BD%8D">2.5. 单位</h2>

<p>写累了，偷个懒，把新东西写了。</p>
<h3 class="mume-header" id="251-gameunit">2.5.1. GameUnit</h3>

<p>命名空间：GameUnit</p>
<h4 class="mume-header" id="2511-%E9%87%8D%E6%9E%84%E9%83%A8%E5%88%86">2.5.1.1. 重构部分</h4>

<ul>
<li>加入适性（Enhence），也就是加四个成员：rEnhence、uEnhence、gEnhence和pEnhence。</li>
</ul>
<h3 class="mume-header" id="252-hero-new">2.5.2. Hero - New!</h3>

<p>命名空间：GameUnit</p>
<p>说明：英雄类，GameUnit的子类。跟一般的单位类比起来多一套运作机制。</p>
<h4 class="mume-header" id="2521-%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98">2.5.2.1. 重要成员</h4>

<ul>
<li>List<string> abilities
<ul>
<li>英雄所具有的异能的id列表。每次英雄重新部署的时候按照这个添加异能上去。</li>
</ul>
</string></li>
<li>List<basecard> arks
<ul>
<li>英雄所携带的战技牌。指针，指向他的单卡。如果该牌已经被销毁，则从这里移除。</li>
</ul>
</basecard></li>
<li>int recoverRate
<ul>
<li>英雄在恢复区每回合获得的恢复量。</li>
</ul>
</li>
<li>int recovered
<ul>
<li>英雄累积的恢复量，超过最大生命值的时候即为CD完成。</li>
</ul>
</li>
</ul>
<h2 class="mume-header" id="26-%E5%BC%82%E8%83%BD%E4%B8%8E%E6%95%88%E6%9E%9C">2.6. 异能与效果</h2>

<h3 class="mume-header" id="261-effectstack-new">2.6.1. EffectStack - New！</h3>

<p>命名空间：Ability</p>
<p>说明：效果句柄堆叠。</p>
<h4 class="mume-header" id="2611-%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98">2.6.1.1. 重要成员</h4>

<ul>
<li>public void push(EffectAction action)
<ul>
<li>将效果句柄压入堆叠</li>
</ul>
</li>
<li>public List<effectaction> actions
<ul>
<li>堆叠中的句柄列表，开始执行的时候由后至前依次执行。</li>
</ul>
</effectaction></li>
<li>public void turnsOn()
<ul>
<li>令堆叠开始逐个pop并执行句柄，直到堆叠清空。</li>
</ul>
</li>
<li>public void turnsOff()
<ul>
<li>令堆叠暂停工作。务必保证在暂停工作之后重启他继续直至排空堆叠。</li>
</ul>
</li>
</ul>
<h3 class="mume-header" id="262-effect-new">2.6.2. Effect - New！</h3>

<p>命名空间：Ability</p>
<p>说明：效果类，负责效果的选择和执行。有一种特殊的效果类为Spell类，在一般效果类基础上增加持有AbilityVariable，并且在Cast的时候会调用卡牌管理器对手牌信息和玩家专注进行操作，并发送施放卡牌的信息。</p>
<h4 class="mume-header" id="2621-%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98">2.6.2.1. 重要成员</h4>

<ul>
<li>public void Cast()
<ul>
<li>暴露给外部施放此牌的方法</li>
</ul>
</li>
<li>public void action()
<ul>
<li>此牌的效果句柄</li>
</ul>
</li>
<li>public void SelectionOver()
<ul>
<li>为此牌选择完效果对象之后执行的方法。一般而言对于选取对象的效果需要在这个方法内将选取的对象存储到自身Effect成员中，方便action使用。</li>
</ul>
</li>
</ul>
<h3 class="mume-header" id="263-ability">2.6.3. Ability</h3>

<p>命名空间：Ability</p>
<p>说明：异能类。</p>
<h4 class="mume-header" id="2631-%E9%87%8D%E6%9E%84%E5%86%85%E5%AE%B9">2.6.3.1. 重构内容</h4>

<ul>
<li>主要是删东西所以就不写重要成员了。等重构完了再来写。</li>
<li>异能目标的概念删除，改为效果对象。异能现在不持有对象约束。</li>
<li>异能不再打表维护了，去外部存储化，目前来看横看竖看都没有外部维护的必要，跟卡牌、单位和事件之类的不同，外部维护只会增加麻烦。</li>
<li>异能是个纯单位概念，不要给非单位绑异能。</li>
<li>特别说一句，对于触发式异能（什么什么时怎么怎么做的这种异能）用Trigger实现的时候，在Trigger的Action里面执行对应的Effect.Excute()就好。对于多段效果的异能，就上一个Effect的action套下一个Effect的Excute依次执行过去。</li>
</ul>
<h3 class="mume-header" id="264-buff">2.6.4. Buff</h3>

<p>命名空间：Ability.Buff</p>
<p>说明：Buff类。</p>
<h4 class="mume-header" id="2641-%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98">2.6.4.1. 重要成员</h4>

<ul>
<li>public void SetLife(float life)
<ul>
<li>设置Buff的生命周期，0.5一个玩家回合/AI回合，1一个玩家回合+AI回合。为负的时候会被设置为永久Buff。</li>
</ul>
</li>
<li>virtual public void InitialBuff() { }
<ul>
<li>设定Buff被赋予时要做的事情</li>
</ul>
</li>
<li>virtual public void OnSubtractBuffLife() { }
<ul>
<li>设定buff的CD在回合结束根据规则减少时触发的效果</li>
</ul>
</li>
<li>virtual protected void OnDisappear() { }
<ul>
<li>设定Buff消失时要做的事情，只要buff消失一定会发生，无论是正常读完的还是被外力清除的。</li>
</ul>
</li>
<li>virtual public void OnComplete() { }
<ul>
<li>设定Buff按照回合数读完发生的事情，比如那种倒计时效果。</li>
</ul>
</li>
<li>virtual public void setVariable(AbilityVariable variable)
<ul>
<li>对于需要使用异能变量的buff重载这个方法来进行书写。参数AbilityVariable。</li>
</ul>
</li>
</ul>
<h2 class="mume-header" id="27-%E4%BA%8B%E4%BB%B6">2.7. 事件</h2>

<p>待补完</p>
<h2 class="mume-header" id="28-%E4%BF%A1%E6%81%AF%E6%94%B6%E5%8F%91">2.8. 信息收发</h2>

<h3 class="mume-header" id="281-msgdispatcher">2.8.1. MsgDispatcher</h3>

<p>命名空间：IMessage</p>
<p>说明：广播站，用于注册接收者和发送信息。</p>
<h4 class="mume-header" id="2811-%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98">2.8.1.1. 重要成员</h4>

<ul>
<li>public static void RegisterMsg()
<ul>
<li>注册信息。有三种注册方法，两种是有实体接收者的，一种只有全局接收者。具体的内容看注释。</li>
</ul>
</li>
<li>public static void SendMsg(int msgName, MsgReceiver targetReceiver = null)
<ul>
<li>发送信息。msgName是MessageType的编号，targetReciver不为空的时候这是一个仅发送给指定目标的单播。</li>
</ul>
</li>
</ul>
<h3 class="mume-header" id="282-trigger">2.8.2. Trigger</h3>

<p>命名空间：IMessage</p>
<p>说明：触发器类。</p>
<h4 class="mume-header" id="2821-%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98">2.8.2.1. 重要成员</h4>

<ul>
<li>public Condition condition;
<ul>
<li>触发时的条件判断句柄</li>
</ul>
</li>
<li>public Action action;
<ul>
<li>触发时的执行句柄</li>
</ul>
</li>
</ul>
<h1 class="mume-header" id="3-%E9%81%AD%E9%81%87%E8%BF%90%E8%A1%8C%E9%80%BB%E8%BE%91%E6%8E%A7%E5%88%B6%E5%92%8C%E6%B5%81%E7%A8%8B">3. 遭遇运行逻辑控制和流程</h1>

<h2 class="mume-header" id="31-%E9%81%AD%E9%81%87%E5%88%9D%E5%A7%8B%E5%8C%96">3.1. 遭遇初始化</h2>

<p>遭遇的初始化依赖于2个信息：牌库信息（Deck实例）和遭遇id（string）。</p>
<p>这部分回头再写，累了。</p>
<h2 class="mume-header" id="32-%E5%9B%9E%E5%90%88%E5%BC%80%E5%A7%8B-%E4%BB%8Eaiend%E5%88%B0mpbegin">3.2. 回合开始 - 从AIEnd到MPBegin</h2>

<p>留空pass</p>
<h2 class="mume-header" id="33-%E5%9B%9E%E5%90%88%E7%BB%93%E6%9D%9F-%E4%BB%8Empend%E5%88%B0aibegin">3.3. 回合结束 - 从MPEnd到AIBegin</h2>

<p>留空pass</p>
<h2 class="mume-header" id="34-%E5%8D%95%E4%BD%8D%E9%83%A8%E7%BD%B2">3.4. 单位部署</h2>

<p>留空pass</p>
<h2 class="mume-header" id="35-%E6%88%98%E6%96%97%E7%BB%93%E7%AE%97">3.5. 战斗结算</h2>

<p>留空pass</p>
<h2 class="mume-header" id="36-%E6%95%88%E6%9E%9C%E9%93%BE%E6%89%A7%E8%A1%8C">3.6. 效果链执行</h2>

<p>效果的定义详情见万律大全。对于复杂的多段效果，我们用效果链的方式实现。效果链由复数个效果构成，每个效果持有一个Excute和Cast。其中Excute负责开启一次选择，在此期间中止堆叠运作形成阻塞，等候选择完毕；Cast则于选择完毕后启动，负责将效果句柄添加到堆叠，并重启堆叠。当我们需要实现一个效果链的时候，我们可以将下一个效果的Excute添加到上一个效果的效果句柄中，从而实现一个接一个效果地执行过去，从而完成复杂的多段效果的结算。</p>
<div class="mermaid" data-processed="true"><svg id="mermaid-1562079176549" width="100%" xmlns="http://www.w3.org/2000/svg" style="max-width: 842.3812561035156px;" viewBox="0 0 842.3812561035156 156"><style>#mermaid-1562079176549 .label{font-family:'trebuchet ms', verdana, arial;color:#333}#mermaid-1562079176549 .node rect,#mermaid-1562079176549 .node circle,#mermaid-1562079176549 .node ellipse,#mermaid-1562079176549 .node polygon{fill:#ECECFF;stroke:#9370db;stroke-width:1px}#mermaid-1562079176549 .node.clickable{cursor:pointer}#mermaid-1562079176549 .arrowheadPath{fill:#333}#mermaid-1562079176549 .edgePath .path{stroke:#333;stroke-width:1.5px}#mermaid-1562079176549 .edgeLabel{background-color:#e8e8e8}#mermaid-1562079176549 .cluster rect{fill:#ffffde !important;stroke:#aa3 !important;stroke-width:1px !important}#mermaid-1562079176549 .cluster text{fill:#333}#mermaid-1562079176549 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:'trebuchet ms', verdana, arial;font-size:12px;background:#ffffde;border:1px solid #aa3;border-radius:2px;pointer-events:none;z-index:100}#mermaid-1562079176549 .actor{stroke:#ccf;fill:#ECECFF}#mermaid-1562079176549 text.actor{fill:#000;stroke:none}#mermaid-1562079176549 .actor-line{stroke:grey}#mermaid-1562079176549 .messageLine0{stroke-width:1.5;stroke-dasharray:'2 2';stroke:#333}#mermaid-1562079176549 .messageLine1{stroke-width:1.5;stroke-dasharray:'2 2';stroke:#333}#mermaid-1562079176549 #arrowhead{fill:#333}#mermaid-1562079176549 #crosshead path{fill:#333 !important;stroke:#333 !important}#mermaid-1562079176549 .messageText{fill:#333;stroke:none}#mermaid-1562079176549 .labelBox{stroke:#ccf;fill:#ECECFF}#mermaid-1562079176549 .labelText{fill:#000;stroke:none}#mermaid-1562079176549 .loopText{fill:#000;stroke:none}#mermaid-1562079176549 .loopLine{stroke-width:2;stroke-dasharray:'2 2';stroke:#ccf}#mermaid-1562079176549 .note{stroke:#aa3;fill:#fff5ad}#mermaid-1562079176549 .noteText{fill:black;stroke:none;font-family:'trebuchet ms', verdana, arial;font-size:14px}#mermaid-1562079176549 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-1562079176549 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-1562079176549 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-1562079176549 .section{stroke:none;opacity:0.2}#mermaid-1562079176549 .section0{fill:rgba(102,102,255,0.49)}#mermaid-1562079176549 .section2{fill:#fff400}#mermaid-1562079176549 .section1,#mermaid-1562079176549 .section3{fill:#fff;opacity:0.2}#mermaid-1562079176549 .sectionTitle0{fill:#333}#mermaid-1562079176549 .sectionTitle1{fill:#333}#mermaid-1562079176549 .sectionTitle2{fill:#333}#mermaid-1562079176549 .sectionTitle3{fill:#333}#mermaid-1562079176549 .sectionTitle{text-anchor:start;font-size:11px;text-height:14px}#mermaid-1562079176549 .grid .tick{stroke:#d3d3d3;opacity:0.3;shape-rendering:crispEdges}#mermaid-1562079176549 .grid path{stroke-width:0}#mermaid-1562079176549 .today{fill:none;stroke:red;stroke-width:2px}#mermaid-1562079176549 .task{stroke-width:2}#mermaid-1562079176549 .taskText{text-anchor:middle;font-size:11px}#mermaid-1562079176549 .taskTextOutsideRight{fill:#000;text-anchor:start;font-size:11px}#mermaid-1562079176549 .taskTextOutsideLeft{fill:#000;text-anchor:end;font-size:11px}#mermaid-1562079176549 .taskText0,#mermaid-1562079176549 .taskText1,#mermaid-1562079176549 .taskText2,#mermaid-1562079176549 .taskText3{fill:#fff}#mermaid-1562079176549 .task0,#mermaid-1562079176549 .task1,#mermaid-1562079176549 .task2,#mermaid-1562079176549 .task3{fill:#8a90dd;stroke:#534fbc}#mermaid-1562079176549 .taskTextOutside0,#mermaid-1562079176549 .taskTextOutside2{fill:#000}#mermaid-1562079176549 .taskTextOutside1,#mermaid-1562079176549 .taskTextOutside3{fill:#000}#mermaid-1562079176549 .active0,#mermaid-1562079176549 .active1,#mermaid-1562079176549 .active2,#mermaid-1562079176549 .active3{fill:#bfc7ff;stroke:#534fbc}#mermaid-1562079176549 .activeText0,#mermaid-1562079176549 .activeText1,#mermaid-1562079176549 .activeText2,#mermaid-1562079176549 .activeText3{fill:#000 !important}#mermaid-1562079176549 .done0,#mermaid-1562079176549 .done1,#mermaid-1562079176549 .done2,#mermaid-1562079176549 .done3{stroke:grey;fill:#d3d3d3;stroke-width:2}#mermaid-1562079176549 .doneText0,#mermaid-1562079176549 .doneText1,#mermaid-1562079176549 .doneText2,#mermaid-1562079176549 .doneText3{fill:#000 !important}#mermaid-1562079176549 .crit0,#mermaid-1562079176549 .crit1,#mermaid-1562079176549 .crit2,#mermaid-1562079176549 .crit3{stroke:#f88;fill:red;stroke-width:2}#mermaid-1562079176549 .activeCrit0,#mermaid-1562079176549 .activeCrit1,#mermaid-1562079176549 .activeCrit2,#mermaid-1562079176549 .activeCrit3{stroke:#f88;fill:#bfc7ff;stroke-width:2}#mermaid-1562079176549 .doneCrit0,#mermaid-1562079176549 .doneCrit1,#mermaid-1562079176549 .doneCrit2,#mermaid-1562079176549 .doneCrit3{stroke:#f88;fill:#d3d3d3;stroke-width:2;cursor:pointer;shape-rendering:crispEdges}#mermaid-1562079176549 .doneCritText0,#mermaid-1562079176549 .doneCritText1,#mermaid-1562079176549 .doneCritText2,#mermaid-1562079176549 .doneCritText3{fill:#000 !important}#mermaid-1562079176549 .activeCritText0,#mermaid-1562079176549 .activeCritText1,#mermaid-1562079176549 .activeCritText2,#mermaid-1562079176549 .activeCritText3{fill:#000 !important}#mermaid-1562079176549 .titleText{text-anchor:middle;font-size:18px;fill:#000}#mermaid-1562079176549 g.classGroup text{fill:#9370db;stroke:none;font-family:'trebuchet ms', verdana, arial;font-size:10px}#mermaid-1562079176549 g.classGroup rect{fill:#ECECFF;stroke:#9370db}#mermaid-1562079176549 g.classGroup line{stroke:#9370db;stroke-width:1}#mermaid-1562079176549 .classLabel .box{stroke:none;stroke-width:0;fill:#ECECFF;opacity:0.5}#mermaid-1562079176549 .classLabel .label{fill:#9370db;font-size:10px}#mermaid-1562079176549 .relation{stroke:#9370db;stroke-width:1;fill:none}#mermaid-1562079176549 #compositionStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1562079176549 #compositionEnd{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1562079176549 #aggregationStart{fill:#ECECFF;stroke:#9370db;stroke-width:1}#mermaid-1562079176549 #aggregationEnd{fill:#ECECFF;stroke:#9370db;stroke-width:1}#mermaid-1562079176549 #dependencyStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1562079176549 #dependencyEnd{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1562079176549 #extensionStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1562079176549 #extensionEnd{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1562079176549 .commit-id,#mermaid-1562079176549 .commit-msg,#mermaid-1562079176549 .branch-label{fill:lightgrey;color:lightgrey}
</style><style>#mermaid-1562079176549 {
    color: rgb(51, 51, 51);
    font: normal normal 400 normal 16px / 25.6px "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif;
  }</style><g transform="translate(-12, -12)"><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath" style="opacity: 1;"><path class="path" d="M133.53125,90L158.53125,90L183.53125,90" marker-end="url(#arrowhead1)" style="fill:none"></path><defs><marker id="arrowhead1" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M283.53125,90L308.53125,90L333.53125,90" marker-end="url(#arrowhead2)" style="fill:none"></path><defs><marker id="arrowhead2" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M600.3524751899326,71.5024721381748L675.8500061035156,42.5L732.8500061035156,42.5" marker-end="url(#arrowhead3)" style="stroke: #333; fill:none;stroke-width:2px;stroke-dasharray:3;"></path><defs><marker id="arrowhead3" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 0 0 L 0 0 z" style="fill: #333"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M600.3524707511564,109.49752619708569L675.8500061035156,137.5L763.6156311035156,137.5" marker-end="url(#arrowhead4)" style="fill:none"></path><defs><marker id="arrowhead4" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M429.546875,90L454.546875,90L480.04687805175774,90.5" marker-end="url(#arrowhead5)" style="fill:none"></path><defs><marker id="arrowhead5" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 0 0 L 0 0 z" style="fill: #333"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(675.8500061035156,42.5)"><g transform="translate(-32,-12.5)" class="label"><foreignobject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">内部执行</span></div></foreignobject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(675.8500061035156,137.5)"><g transform="translate(-32,-12.5)" class="label"><foreignobject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">进入堆叠</span></div></foreignobject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignobject></g></g></g><g class="nodes"><g class="node" id="C" transform="translate(76.765625,90)" style="opacity: 1;"><rect rx="5" ry="5" x="-56.765625" y="-22.5" width="113.53125" height="45"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-46.765625,-12.5)"><foreignobject width="93.53125" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">效果1 Excute</div></foreignobject></g></g></g><g class="node" id="D" transform="translate(549.1984405517578,90)" style="opacity: 1;"><polygon points="69.6515625,0 139.303125,-69.6515625 69.6515625,-139.303125 0,-69.6515625" rx="5" ry="5" transform="translate(-69.6515625,69.6515625)"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-44.890625,-12.5)"><foreignobject width="89.78125" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">效果1 action</div></foreignobject></g></g></g><g class="node" id="G" transform="translate(381.5390625,90)" style="opacity: 1;"><rect rx="5" ry="5" x="-48.0078125" y="-22.5" width="96.015625" height="45"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-38.0078125,-12.5)"><foreignobject width="76.015625" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">效果1 Cast</div></foreignobject></g></g></g><g class="node" id="E" transform="translate(789.6156311035156,137.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-26" y="-22.5" width="52" height="45"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-16,-12.5)"><foreignobject width="32" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">堆叠</div></foreignobject></g></g></g><g class="node" id="F" transform="translate(789.6156311035156,42.5)" style="opacity: 1;"><rect rx="5" ry="5" x="-56.765625" y="-22.5" width="113.53125" height="45"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-46.765625,-12.5)"><foreignobject width="93.53125" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">效果2 Excute</div></foreignobject></g></g></g><g class="node" id="H" transform="translate(233.53125,90)" style="opacity: 1;"><rect rx="0" ry="0" x="-50" y="-22.5" width="100" height="45"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-40,-12.5)"><foreignobject width="80" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">选择状态机</div></foreignobject></g></g></g></g></g></g></svg></div><h2 class="mume-header" id="37-%E5%A0%86%E5%8F%A0%E7%9A%84%E8%BF%90%E4%BD%9C%E6%9C%BA%E5%88%B6">3.7. 堆叠的运作机制</h2>

<p>留空pass</p>
<h2 class="mume-header" id="38-%E5%8D%A1%E7%89%8C%E6%96%BD%E6%94%BE">3.8. 卡牌施放</h2>

<p>留空pass</p>
<h2 class="mume-header" id="39-%E5%BC%82%E8%83%BD%E8%A7%A6%E5%8F%91">3.9. 异能触发</h2>

<p>异能触发是对于触发式异能而言的概念。一个触发式异能含有两个成分：触发条件（Condition），和触发后执行的效果链（Effect Chain）。我们用Trigger来实现一个触发式异能的触发。首先我们需要初始化一个异能。一个异能触发式持有以下成员：</p>
<div class="mermaid" data-processed="true"><svg id="mermaid-1562079176673" width="100%" xmlns="http://www.w3.org/2000/svg" style="max-width: 358.19921875px;" viewBox="0 0 358.19921875 371"><style>#mermaid-1562079176673 .label{font-family:'trebuchet ms', verdana, arial;color:#333}#mermaid-1562079176673 .node rect,#mermaid-1562079176673 .node circle,#mermaid-1562079176673 .node ellipse,#mermaid-1562079176673 .node polygon{fill:#ECECFF;stroke:#9370db;stroke-width:1px}#mermaid-1562079176673 .node.clickable{cursor:pointer}#mermaid-1562079176673 .arrowheadPath{fill:#333}#mermaid-1562079176673 .edgePath .path{stroke:#333;stroke-width:1.5px}#mermaid-1562079176673 .edgeLabel{background-color:#e8e8e8}#mermaid-1562079176673 .cluster rect{fill:#ffffde !important;stroke:#aa3 !important;stroke-width:1px !important}#mermaid-1562079176673 .cluster text{fill:#333}#mermaid-1562079176673 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:'trebuchet ms', verdana, arial;font-size:12px;background:#ffffde;border:1px solid #aa3;border-radius:2px;pointer-events:none;z-index:100}#mermaid-1562079176673 .actor{stroke:#ccf;fill:#ECECFF}#mermaid-1562079176673 text.actor{fill:#000;stroke:none}#mermaid-1562079176673 .actor-line{stroke:grey}#mermaid-1562079176673 .messageLine0{stroke-width:1.5;stroke-dasharray:'2 2';stroke:#333}#mermaid-1562079176673 .messageLine1{stroke-width:1.5;stroke-dasharray:'2 2';stroke:#333}#mermaid-1562079176673 #arrowhead{fill:#333}#mermaid-1562079176673 #crosshead path{fill:#333 !important;stroke:#333 !important}#mermaid-1562079176673 .messageText{fill:#333;stroke:none}#mermaid-1562079176673 .labelBox{stroke:#ccf;fill:#ECECFF}#mermaid-1562079176673 .labelText{fill:#000;stroke:none}#mermaid-1562079176673 .loopText{fill:#000;stroke:none}#mermaid-1562079176673 .loopLine{stroke-width:2;stroke-dasharray:'2 2';stroke:#ccf}#mermaid-1562079176673 .note{stroke:#aa3;fill:#fff5ad}#mermaid-1562079176673 .noteText{fill:black;stroke:none;font-family:'trebuchet ms', verdana, arial;font-size:14px}#mermaid-1562079176673 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-1562079176673 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-1562079176673 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-1562079176673 .section{stroke:none;opacity:0.2}#mermaid-1562079176673 .section0{fill:rgba(102,102,255,0.49)}#mermaid-1562079176673 .section2{fill:#fff400}#mermaid-1562079176673 .section1,#mermaid-1562079176673 .section3{fill:#fff;opacity:0.2}#mermaid-1562079176673 .sectionTitle0{fill:#333}#mermaid-1562079176673 .sectionTitle1{fill:#333}#mermaid-1562079176673 .sectionTitle2{fill:#333}#mermaid-1562079176673 .sectionTitle3{fill:#333}#mermaid-1562079176673 .sectionTitle{text-anchor:start;font-size:11px;text-height:14px}#mermaid-1562079176673 .grid .tick{stroke:#d3d3d3;opacity:0.3;shape-rendering:crispEdges}#mermaid-1562079176673 .grid path{stroke-width:0}#mermaid-1562079176673 .today{fill:none;stroke:red;stroke-width:2px}#mermaid-1562079176673 .task{stroke-width:2}#mermaid-1562079176673 .taskText{text-anchor:middle;font-size:11px}#mermaid-1562079176673 .taskTextOutsideRight{fill:#000;text-anchor:start;font-size:11px}#mermaid-1562079176673 .taskTextOutsideLeft{fill:#000;text-anchor:end;font-size:11px}#mermaid-1562079176673 .taskText0,#mermaid-1562079176673 .taskText1,#mermaid-1562079176673 .taskText2,#mermaid-1562079176673 .taskText3{fill:#fff}#mermaid-1562079176673 .task0,#mermaid-1562079176673 .task1,#mermaid-1562079176673 .task2,#mermaid-1562079176673 .task3{fill:#8a90dd;stroke:#534fbc}#mermaid-1562079176673 .taskTextOutside0,#mermaid-1562079176673 .taskTextOutside2{fill:#000}#mermaid-1562079176673 .taskTextOutside1,#mermaid-1562079176673 .taskTextOutside3{fill:#000}#mermaid-1562079176673 .active0,#mermaid-1562079176673 .active1,#mermaid-1562079176673 .active2,#mermaid-1562079176673 .active3{fill:#bfc7ff;stroke:#534fbc}#mermaid-1562079176673 .activeText0,#mermaid-1562079176673 .activeText1,#mermaid-1562079176673 .activeText2,#mermaid-1562079176673 .activeText3{fill:#000 !important}#mermaid-1562079176673 .done0,#mermaid-1562079176673 .done1,#mermaid-1562079176673 .done2,#mermaid-1562079176673 .done3{stroke:grey;fill:#d3d3d3;stroke-width:2}#mermaid-1562079176673 .doneText0,#mermaid-1562079176673 .doneText1,#mermaid-1562079176673 .doneText2,#mermaid-1562079176673 .doneText3{fill:#000 !important}#mermaid-1562079176673 .crit0,#mermaid-1562079176673 .crit1,#mermaid-1562079176673 .crit2,#mermaid-1562079176673 .crit3{stroke:#f88;fill:red;stroke-width:2}#mermaid-1562079176673 .activeCrit0,#mermaid-1562079176673 .activeCrit1,#mermaid-1562079176673 .activeCrit2,#mermaid-1562079176673 .activeCrit3{stroke:#f88;fill:#bfc7ff;stroke-width:2}#mermaid-1562079176673 .doneCrit0,#mermaid-1562079176673 .doneCrit1,#mermaid-1562079176673 .doneCrit2,#mermaid-1562079176673 .doneCrit3{stroke:#f88;fill:#d3d3d3;stroke-width:2;cursor:pointer;shape-rendering:crispEdges}#mermaid-1562079176673 .doneCritText0,#mermaid-1562079176673 .doneCritText1,#mermaid-1562079176673 .doneCritText2,#mermaid-1562079176673 .doneCritText3{fill:#000 !important}#mermaid-1562079176673 .activeCritText0,#mermaid-1562079176673 .activeCritText1,#mermaid-1562079176673 .activeCritText2,#mermaid-1562079176673 .activeCritText3{fill:#000 !important}#mermaid-1562079176673 .titleText{text-anchor:middle;font-size:18px;fill:#000}#mermaid-1562079176673 g.classGroup text{fill:#9370db;stroke:none;font-family:'trebuchet ms', verdana, arial;font-size:10px}#mermaid-1562079176673 g.classGroup rect{fill:#ECECFF;stroke:#9370db}#mermaid-1562079176673 g.classGroup line{stroke:#9370db;stroke-width:1}#mermaid-1562079176673 .classLabel .box{stroke:none;stroke-width:0;fill:#ECECFF;opacity:0.5}#mermaid-1562079176673 .classLabel .label{fill:#9370db;font-size:10px}#mermaid-1562079176673 .relation{stroke:#9370db;stroke-width:1;fill:none}#mermaid-1562079176673 #compositionStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1562079176673 #compositionEnd{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1562079176673 #aggregationStart{fill:#ECECFF;stroke:#9370db;stroke-width:1}#mermaid-1562079176673 #aggregationEnd{fill:#ECECFF;stroke:#9370db;stroke-width:1}#mermaid-1562079176673 #dependencyStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1562079176673 #dependencyEnd{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1562079176673 #extensionStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1562079176673 #extensionEnd{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1562079176673 .commit-id,#mermaid-1562079176673 .commit-msg,#mermaid-1562079176673 .branch-label{fill:lightgrey;color:lightgrey}
</style><style>#mermaid-1562079176673 {
    color: rgb(51, 51, 51);
    font: normal normal 400 normal 16px / 25.6px "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif;
  }</style><g transform="translate(-12, -12)"><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath" style="opacity: 1;"><path class="path" d="M183.015625,65L158.3671875,90L158.3671875,115" marker-end="url(#arrowhead6)" style="fill:none"></path><defs><marker id="arrowhead6" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 0 0 L 0 0 z" style="fill: #333"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M231.19921875,52.55470041979392L328.02734375,90L328.02734375,137.5L328.02734375,185L328.02734375,232.5L328.02734375,292.5L300.5615234375,330" marker-end="url(#arrowhead7)" style="fill:none"></path><defs><marker id="arrowhead7" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 0 0 L 0 0 z" style="fill: #333"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M121.00164473684211,160L79.484375,185L79.484375,210" marker-end="url(#arrowhead8)" style="fill:none"></path><defs><marker id="arrowhead8" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 0 0 L 0 0 z" style="fill: #333"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M195.7327302631579,160L237.25,185L237.25,210" marker-end="url(#arrowhead9)" style="fill:none"></path><defs><marker id="arrowhead9" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 0 0 L 0 0 z" style="fill: #333"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M237.25,255L237.25,292.5L266.52001953125,330" marker-end="url(#arrowhead10)" style="fill:none"></path><defs><marker id="arrowhead10" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(237.25,292.5)"><g transform="translate(-67.890625,-12.5)" class="label"><foreignobject width="135.78125" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">EffectChain.Excute</span></div></foreignobject></g></g></g><g class="nodes"><g class="node" id="A" transform="translate(205.19921875,42.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-26" y="-22.5" width="52" height="45"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-16,-12.5)"><foreignobject width="32" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">异能</div></foreignobject></g></g></g><g class="node" id="B" transform="translate(158.3671875,137.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-58.6640625" y="-22.5" width="117.328125" height="45"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-48.6640625,-12.5)"><foreignobject width="97.328125" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">触发器Trigger</div></foreignobject></g></g></g><g class="node" id="C" transform="translate(79.484375,232.5)" style="opacity: 1;"><rect rx="5" ry="5" x="-59.484375" y="-22.5" width="118.96875" height="45"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-49.484375,-12.5)"><foreignobject width="98.96875" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">condition句柄</div></foreignobject></g></g></g><g class="node" id="D" transform="translate(237.25,232.5)" style="opacity: 1;"><rect rx="5" ry="5" x="-48.28125" y="-22.5" width="96.5625" height="45"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-38.28125,-12.5)"><foreignobject width="76.5625" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">action句柄</div></foreignobject></g></g></g><g class="node" id="E" transform="translate(284.08203125,352.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-78.1171875" y="-22.5" width="156.234375" height="45"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-68.1171875,-12.5)"><foreignobject width="136.234375" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">效果链Effect Chain</div></foreignobject></g></g></g></g></g></g></svg></div><p>在这里condition句柄充当者触发条件的职能。而触发器的action句柄则用来开启效果链的执行。</p>
<h1 class="mume-header" id="4-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9%E5%92%8C%E9%80%9A%E7%94%A8%E7%B1%BB%E7%9A%84%E4%BD%BF%E7%94%A8">4. 注意事项和通用类的使用</h1>

<h2 class="mume-header" id="41-fsmachinet%E5%92%8Cfsmstate">4.1. FSMachine<t>和FSMState</t></h2>

<p>说明：通用有限状态机类和对应的有限状态机状态类。这两个类并不能直接使用，正确用法是将其作为基类继承</p>
<h3 class="mume-header" id="411-%E4%BE%8B%E5%AD%90">4.1.1. 例子：</h3>

<pre data-role="codeBlock" data-info="c##" class="language-c##"><code>class InputFSM : FSMachine&lt;InputFSMState&gt; //这是有限状态机的声明
class InputFSMState : FSMState //这是对应有限状态机的状态的声明
</code></pre><h2 class="mume-header" id="42-unitysingleton">4.2. UnitySingleton</h2>

<p>说明：单例通用类，用以给某一基类是monobehaviour的class创建并约束实例唯一并可在任意代码块引用到</p>
<h3 class="mume-header" id="421-%E4%BE%8B%E5%AD%90">4.2.1. 例子：</h3>

<pre data-role="codeBlock" data-info="c#" class="language-c#"><code>public class BattleMap : UnitySingleton&lt;BattleMap&gt;
{}
</code></pre><p>引用唯一实例的方法：ClassName.Instance()</p>
<p>实现细节：这个类在一个场景被第一次调用实例时，会在场景搜索使用了该基类的c##脚本，如果这个脚本存在则保存为唯一实例并返回，若不存在则以该实例的classname创建一个gameobject并挂载对应的c##脚本并保存为唯一实力并返回。所以如果在场景里没有提前放置单例脚本，则会在运行的过程中在场景中创建。</p>
<p>注意事项：因为unity的场景加载是将这个场景里的预制件全部生成一遍，所以单例一旦有dontdestroy的需求就会造成加载场景后会有多个单例的gameobject，需要尽量避免这两种需求的同时出现，要么放弃使用单例。在任何时候，尽量少地使用单例，原则上能不使用就不使用</p>
</object></li></ul>
      </div>
      
      
    
    
    <script>
// config mermaid init call
// http://knsv.github.io/mermaid/#configuration
//
// You can edit the 'MERMAID_CONFIG' variable below.
MERMAID_CONFIG = {
  startOnLoad: false
  mermaidTheme: "mermaid.forest.css"
}

if (window['MERMAID_CONFIG']) {
  window['MERMAID_CONFIG'].startOnLoad = false
  window['MERMAID_CONFIG'].cloneCssStyles = false
  window['MERMAID_CONFIG'].theme = "mermaid.css"
}
mermaid.initialize(window['MERMAID_CONFIG'] || {})

if (typeof(window['Reveal']) !== 'undefined') {
  function mermaidRevealHelper(event) {
    var currentSlide = event.currentSlide
    var diagrams = currentSlide.querySelectorAll('.mermaid')
    for (var i = 0; i < diagrams.length; i++) {
      var diagram = diagrams[i]
      if (!diagram.hasAttribute('data-processed')) {
        mermaid.init(null, diagram, ()=> {
          Reveal.slide(event.indexh, event.indexv)
        })
      }
    }
  }

  Reveal.addEventListener('slidechanged', mermaidRevealHelper)
  Reveal.addEventListener('ready', mermaidRevealHelper)
} else {
  mermaid.init(null, document.getElementsByClassName('mermaid'))
}
</script>
    
    
    
    
    
  <div class="mermaidTooltip" style="opacity: 0;"></div></body></html>